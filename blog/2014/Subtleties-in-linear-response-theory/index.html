<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Subtleties in linear response theory | Justin H. Wilson</title>
    <meta name="author" content="Justin H. Wilson">
    <meta name="description" content="">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://jhwilson.github.io/blog/2014/Subtleties-in-linear-response-theory/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Justin </span>H. Wilson</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item active">
                <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">publications</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/teaching/">teaching</a>
              </li>
              <li class="nav-item dropdown ">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">resources</a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="https://element.condmat.org" rel="external nofollow noopener" target="_blank">Element</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="https://github.com/" rel="external nofollow noopener" target="_blank">Github</a>
                </div>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      <!-- _layouts/post.html -->

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Subtleties in linear response theory</h1>
    <p class="post-meta">December 22, 2014</p>
    <p class="post-tags">
      <a href="/blog/2014"> <i class="fas fa-calendar fa-sm"></i> 2014 </a>
        ·  
        <a href="/blog/category/short-calculations">
          <i class="fas fa-tag fa-sm"></i> short-calculations</a>  
          

    </p>
  </header>

  <article class="post-content">
    <p>In linear response theory, we consider some small perturbation to a Hamiltonian and look at the response of some observable to that perturbation. In the case considered here, the perturbation is an electric field, and the response is current. The linear response that characterizes these quantities is called the conductance.
<!--more--></p>

<p>There’s a problem though, an electric field <em>accelerates</em> a charge. Consider a classical electron for the time being, then</p>

\[\begin{align}
m \ddot x(t) = - e \mathbf{E}. \label{eq:Newton} 
\end{align}\]

<p>Or in terms of current \(j(t) = -e \dot x(t)\), \(\frac{d j}{dt} = \frac{e^2}{m} \mathbf{E}\). From here we can quickly and naively go to frequency space to find \(j(\omega) = i \frac{e^2/m}{\omega} \mathbf{E}(\omega)\). Then one might remember that another way to define \(\mathbf{E}\) is in terms of a vector potential that is purely time-dependent, so \(\mathbf{E}(\omega) = i \omega \mathbf A(\omega)\). Now, if we just plug this into our linear response for the current, we get</p>

\[j(\omega) = - \frac{ e^2}{m} \mathbf A(\omega). \label{eq:jA}\]

<p>All is well and good, right? Well, not quite. In electromagnetism, the constant part of \(\mathbf A(t)\) corresponds to the \(\omega = 0\) term of \(A(\omega)\). This represents what is known as a “pure gauge”. These gauges are <em>physically equivalent</em> to the null field \(\mathbf A(\omega=0) = 0\). Thus, whatever linear response is represented above at \(\omega = 0\) must be unphysical, right?</p>

<p>Wrong.</p>

<p>Before explainging why this is wrong, let’s give some further context to this linear response theory. The term \(- e^2/m\) is actually the single particle term of what is known as the “diamagnetic” response to the conductivity when you add in more electrons (usually distributed in a Fermi distribution). This term persists in quantum mechanics, and no other terms appear to cancel it in the simplest case of \(H = \frac{p^2}{2m}\). In fact, while the math becomes more cumbersome, the solution we shall illustate below holds perfectly well for even the non-interacting multi-electron system.</p>

<p>Now, at this point you may have guessed that there’s something strange going on at \(\omega = 0\) due to the fact that the electric field <em>accelerates</em> the particle and doesn’t just have a velocity response. At the \(\omega = 0\) point, the <em>physical</em> field \(E(\omega)\) seems to necessarily be equal to zero in the gauge we have prescribed unless \(A(\omega) \sim 1/\omega\) for small \(\omega\). This would lead to a divergent \(j(\omega)\), restoring our faith that the system is accelerating out of control.</p>

<p>But what about when \(\mathbf{A}(\omega=0) = \mathbf{A}_0\)? It seems like then we have a true velocity response to an unphysical object. The solution is subtle: At some point in the quick derivation we made an assumption that implied \(\mathbf A(t) \rightarrow 0\) at \(t \rightarrow -\infty\). This implies that if \(\mathbf A(t) = \mathbf A_0\) at any finite time, there had to be some time in between where \(d\mathbf A/ dt \neq 0\). Thus, during that “ramp up” time, an electric field was on and it accelerated the charge to a specific velocity resulting in the current \(j(\omega) = - \frac{ e^2}{m} \mathbf A(\omega)\).</p>

<p>The assumption is subtle, but the result is rather simple. For now, just assume that \(\mathbf A(-\infty) = 0\) and at some \(t_0\), \(\mathbf A(t_0) = \mathbf A_0\), then we can integrate Eq. \eqref{eq:Newton} to obtain the velocity:</p>

\[m \dot x (t_0) =  e \int_{-\infty}^{t_0} \frac{d \mathbf A}{d t} d t = e \mathbf A_0.\]

<p>Or, in other words, \(\mathbf j(t_0) = -\frac{e^2}{m} \mathbf A_0\), the same as before! This is how a constant \(\mathbf A_0\) can be physical: When it represents the change from a different constant vector potential.</p>

<p>Now, to isolate the assumption, let us run through what they were</p>

<ol>
  <li>\(\frac{d j}{d t} = \frac{e^2}{m} E(t)\).</li>
  <li>Take the Fourier transform: \(j(\omega) = i \frac{e^2/m}{\omega} E(\omega)\).</li>
  <li>Insert vector potential with \(E = -\frac{d}{dt} A\) and <em>assume the Fourier transform exists</em> for \(A\): \(j(\omega) = - \frac{e^2}m A(\omega)\).</li>
  <li>Undo the Fourier transform: \(j(t) = - \frac{e^2}{m} A(t)\).</li>
</ol>

<p>Now, let us get the last equation (in #4 above) by a simpler route.</p>

<ol>
  <li>\(\frac{d j}{dt} = \frac{e^2}{m} E(t)\).</li>
  <li>Use \(E = - \frac{d}{dt} A\) and integrate the above expression from \(-\infty\) to \(t\): \(j(t) - j(-\infty) = -\frac{e^2}{m} ( A(t) - A(-\infty))\).</li>
</ol>

<p>Two perfectly legitimate calculations resulting in different results. Firstly, this highlights that the first procedure does actually assume \(A(-\infty) = 0\). Secondly, the only assumptions that could have given \(j(-\infty) = 0\) (an assumption we probably wanted anyway) and \(A(-\infty) = 0\) are that they could be given in terms of Fourier transforms. In order for a function to have a Fourier transform it needs to be <em>absolutely integrable</em>—i.e. \(\int_{-\infty}^\infty \lvert A(t) \rvert dt \lt \infty\). Given \(A(t)\) as a continuous, piece-wise differentiable function, we need \(A(t) \rightarrow 0\) for \(t \rightarrow \pm \infty\). This imposes our gauge, and since we are not interested in future times let alone \(t \rightarrow +\infty\), we can artificially modify the function as we see fit to accomodate that. But how the function began at \(-\infty\) is important, and we must impose that. Hence, we have chosen, at least partially, a gauge.</p>

<p>We are left with a dilemma then about pure plain waves \(A(t) = A(\omega) e^{-i \omega t}\). How do those function?</p>

<p>Technically, they are outside of the bounds of the Fourier analysis and we can see that simply by the fact that if we tried to do the above procedure, we couldn’t have a well defined answer as \(t \rightarrow -\infty\) (too oscillatory). However, we can approximate the plain wave in terms of an absolutely integrable function \(A_\delta(t) = A(\omega) e^{-i (\omega + i \delta) t}\) for any \(\delta \gt 0\), and everything works. This shows us explicitly that \(t = - \infty\) does have \(A_\delta \rightarrow 0\) for all \(\delta \gt 0\). And this is the origin of the well known substitution \(\omega \rightarrow \omega + i\delta\).</p>

<p>The natural question to ask now is how this works for a real system (with dissipation). Why does such a term not exist at zero frequency?</p>

<p>Unless your system is a superconductor, there is some dissipation in the system.
The simplest way to include this is classically: When an electron is going at velocity \(\dot x(t)\) it experiences a “drag” that tends to slow it down.
Thus, our Newton’s equations become</p>

\[m \ddot x(t) = - m \gamma \dot x(t) - e \mathbf E\]

<p>where \(\gamma\) describes how much drag the electron experiences.
For more disorder, this would be a larger number.
Playing the same Fourier transform game, we can obtain rather quickly that</p>

\[j(\omega) = - \frac{e^2}{m} \frac{\omega}{\omega  +i  \gamma}  A(\omega).\]

<p>This is just one step away from the well-known <a href="http://en.wikipedia.org/wiki/Drude_model" rel="external nofollow noopener" target="_blank">Drude model</a>.
We see that if \(A(t) = A_0\), then \(j(\omega) = 0\).
But our gauge choice that we described before is still in place, the only difference is that our “kick” at \(t=-\infty\) has an infinite time to dissipate back to rest (the inclusion of \(\gamma\) above is critical for \(j(\omega=0) =0\)).
This also suggests a steady state current when \(\mathbf E\) is constant: \(m\ddot x=0\) implies \(j = \frac{e^2}{m \gamma} \mathbf E\).
Our current relaxes to zero when there’s nothing around (\(\mathbf E = 0\)), as we would expect.</p>

<p>When a quantum mechanical description is done—by taking a random disorder potential and averaging over disorder configurations—one obtains similar results.
The diamagnetic term for a <em>clean system</em> is real and has a physically well defined explanation.</p>

<p>One may not be surprised that this curious “diamagnetic term” occurs for superconductors, however it is sometimes explained that “gauge symmetry is broken” and that is why such a term exists.
This is a misleading statement, but one I will explore in a future post.</p>

  </article>


  
    
    <br>
    <hr>
    <br>
    <ul class="list-disc pl-8"></ul>

    <!-- Adds related posts to the end of an article -->
    <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2>
    <p class="mb-2">Here are some more articles you might like to read next:</p>
  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2022/Noether-classical/">Noether's theorem in classical mechanics</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2022/SSH-model/">A topological analysis of the Su-Schrieffer-Heeger model</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/bound-state-continuum/">The effect of a bound state on the continuum</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/Quasicrystalline-Art/">Quasicrystalline Art</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2017/Chern-Number-From-Real-Time/">Pulsing a two-band model to discover topology</a>
  </li>

</div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2023 Justin H. Wilson. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script defer src="/assets/js/common.js"></script>
  <script defer src="/assets/js/copy_code.js" type="text/javascript"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  <script async src="https://badge.dimensions.ai/badge.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
